Practical No.: 5 Write a Python script to perform image filtering in frequency domain. 
 
 
import cv2 
importnumpy as np 
importmatplotlib.pyplot as plt 
 
defcreate_filter(shape, filter_type='low_pass', cutoff=30): 
rows, cols = shape 
crow, ccol = rows // 2, cols // 2 
filter_mask = np.zeros((rows, cols), np.float32) 
 
iffilter_type == 'low_pass': 
cv2.circle(filter_mask, (ccol, crow), cutoff, 1, thickness=-1) 
eliffilter_type == 'high_pass': 
filter_mask = np.ones((rows, cols), np.float32) 
cv2.circle(filter_mask, (ccol, crow), cutoff, 0, thickness=-1) 
 
returnfilter_mask 
 
deffilter_frequency_domain(image, filter_type='low_pass', cutoff=30): 
 
    # Convert image to float32 for precision 
image = np.float32(image) 
 
    # Perform FFT 
dft = cv2.dft(image, flags=cv2.DFT_COMPLEX_OUTPUT) 
dft_shift = np.fft.fftshift(dft) 
 
    # Create filter mask 
filter_mask = create_filter(image.shape, filter_type, cutoff) 
 
    # Apply filter 
filtered_dft_shift = dft_shift * filter_mask[..., np.newaxis] 
 
    # Inverse FFT 
dft_ishift = np.fft.ifftshift(filtered_dft_shift) 
img_back = cv2.idft(dft_ishift) 
img_back = cv2.magnitude(img_back[:, :, 0], img_back[:, :, 1]) 
 
    # Normalize the result 
img_back = np.abs(img_back) 
img_back = cv2.normalize(img_back, None, 0, 255, cv2.NORM_MINMAX) 
img_back = np.uint8(img_back) 
 
returnimg_back 
 
def main(): 
    # Read the image 
image = cv2.imread('E:\\Msc\\leaf.jpg', cv2.IMREAD_GRAYSCALE) 
if image is None: 
print("Error: Image not found.") 
return 
 
    # Parameters 
low_pass_cutoff = 30 
high_pass_cutoff = 30 
 
    # Apply Low Pass Filter 
low_pass_filtered_image = filter_frequency_domain(image, 'low_pass', low_pass_cutoff) 
 
    # Apply High Pass Filter 
high_pass_filtered_image = filter_frequency_domain(image, 'high_pass', high_pass_cutoff) 
 
    # Display the original and filtered images 
plt.figure(figsize=(18, 6)) 
 
plt.subplot(1, 3, 1) 
plt.title('Original Image') 
plt.imshow(image, cmap='gray') 
 
plt.subplot(1, 3, 2) 
plt.title('Low Pass Filtered Image') 
plt.imshow(low_pass_filtered_image, cmap='gray') 
 
plt.subplot(1, 3, 3) 
plt.title('High Pass Filtered Image') 
plt.imshow(high_pass_filtered_image, cmap='gray') 
 
plt.show() 
 
if __name__ == "__main__": 
main() 
 
Output 
 
 

 
 
 
 
 